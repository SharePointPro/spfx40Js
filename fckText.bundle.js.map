{"version":3,"sources":["webpack:///../webpack/bootstrap 861221b1c1021c040432?b4ae*************************************","webpack:///../external \"@microsoft/sp-core-library\"?b12b*************************************","webpack:///../external \"@microsoft/sp-loader\"?a068****","webpack:///../external \"fckTextStrings\"","webpack:///../../../../src/webparts/fckText/FckTextWebPart.ts","webpack:///../external \"@microsoft/sp-webpart-base\"?2e17*************************************"],"names":[],"mappings":"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","file":"fckText.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 427);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 861221b1c1021c040432","module.exports = __WEBPACK_EXTERNAL_MODULE_11__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-core-library\"\n// module id = 11\n// module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38","module.exports = __WEBPACK_EXTERNAL_MODULE_263__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-loader\"\n// module id = 263\n// module chunks = 11 13 23 34 35 38","module.exports = __WEBPACK_EXTERNAL_MODULE_336__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fckTextStrings\"\n// module id = 336\n// module chunks = 38","/**\r\n * @file\r\n * FckText Web Part for SharePoint Framework SPFx\r\n *\r\n * Author: Olivier Carpentier\r\n * Copyright (c) 2016\r\n */\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  IWebPartContext,\r\n  PropertyPaneToggle\r\n} from '@microsoft/sp-webpart-base';\r\nimport { DisplayMode, Version } from '@microsoft/sp-core-library';\r\nimport { Environment, EnvironmentType } from '@microsoft/sp-core-library';\r\n\r\nimport * as strings from 'fckTextStrings';\r\nimport { IFckTextWebPartProps } from './IFckTextWebPartProps';\r\nimport { SPComponentLoader } from '@microsoft/sp-loader';\r\n\r\nexport default class FckTextWebPart extends BaseClientSideWebPart<IFckTextWebPartProps> {\r\n\r\n  private guid: string;\r\n\r\n  /**\r\n   * @function\r\n   * Web part contructor.\r\n   */\r\n  public constructor(context?: IWebPartContext) {\r\n    super();\r\n\r\n    this.guid = this.getGuid();\r\n\r\n    //Hack: to invoke correctly the onPropertyChange function outside this class\r\n    //we need to bind this object on it first\r\n    this.onPropertyPaneFieldChanged = this.onPropertyPaneFieldChanged.bind(this);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Gets WP data version\r\n   */\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders HTML code\r\n   */\r\n  public render(): void {\r\n\r\n    if (Environment.type === EnvironmentType.ClassicSharePoint) {\r\n      var errorHtml = '';\r\n      errorHtml += '<div style=\"color: red;\">';\r\n      errorHtml += '<div style=\"display:inline-block; vertical-align: middle;\"><i class=\"ms-Icon ms-Icon--Error\" style=\"font-size: 20px\"></i></div>';\r\n      errorHtml += '<div style=\"display:inline-block; vertical-align: middle;margin-left:7px;\"><span>';\r\n      errorHtml += strings.ErrorClassicSharePoint;\r\n      errorHtml += '</span></div>';\r\n      errorHtml += '</div>';\r\n      this.domElement.innerHTML = errorHtml;\r\n      return;\r\n    }\r\n\r\n\r\n    if (this.displayMode == DisplayMode.Edit) {\r\n      //Edit mode\r\n      var html = '';\r\n      html += \"<textarea name='\" + this.guid + \"-editor' id='\" + this.guid + \"-editor'>\" + this.properties.text + \"</textarea>\";\r\n      this.domElement.innerHTML = html;\r\n\r\n      var ckEditorCdn: string = '//cdn.ckeditor.com/4.6.2/full/ckeditor.js';\r\n      SPComponentLoader.loadScript(ckEditorCdn, { globalExportsName: 'CKEDITOR' }).then((CKEDITOR: any): void => {\r\n        if (this.properties.inline == null || this.properties.inline === false)\r\n          CKEDITOR.replace( this.guid + '-editor', {\r\n              skin: 'moono-lisa,//cdn.ckeditor.com/4.6.2/full-all/skins/moono-lisa/'\r\n          }  );\r\n        else\r\n          CKEDITOR.inline( this.guid + '-editor', {\r\n              skin: 'moono-lisa,//cdn.ckeditor.com/4.6.2/full-all/skins/moono-lisa/'\r\n          }   );\r\n\r\n        for (var i in CKEDITOR.instances) {\r\n          CKEDITOR.instances[i].on('change', (elm?, val?) =>\r\n          {\r\n            //CKEDITOR.instances[i].updateElement();\r\n            elm.sender.updateElement();\r\n            var value = ((document.getElementById(this.guid + '-editor')) as any).value;\r\n            if (this.onPropertyPaneFieldChanged && value != null) {\r\n              this.properties.text = value;\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }\r\n    else {\r\n      //Read Mode\r\n      this.domElement.innerHTML = this.properties.text;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID\r\n   */\r\n  private getGuid(): string {\r\n    return this.s4() + this.s4() + '-' + this.s4() + '-' + this.s4() + '-' +\r\n      this.s4() + '-' + this.s4() + this.s4() + this.s4();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID part\r\n   */\r\n  private s4(): string {\r\n      return Math.floor((1 + Math.random()) * 0x10000)\r\n        .toString(16)\r\n        .substring(1);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * PropertyPanel settings definition\r\n   */\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          displayGroupsAsAccordion: false,\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyPaneToggle('inline', {\r\n                  label: strings.Inline,\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/webparts/fckText/FckTextWebPart.ts","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-webpart-base\"\n// module id = 5\n// module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38"],"sourceRoot":""}